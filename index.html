<html lang="pt-BR">

<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }

        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 30px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        .language-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 999;
        }
    </style>
</head>

<body>
    <div class="language-toggle">
        <select id="languageSelect" class="form-select form-select-sm">
            <option value="pt">Português</option>
            <option value="en">English</option>
        </select>
    </div>
    <div class="login-container">
        <h2 class="text-center" id="loginTitle">Login</h2>
        <form id="loginForm">
            <div class="mb-3">
                <label for="username" class="form-label" id="usernameLabel">Nome de usuário</label>
                <input type="text" class="form-control" id="username" required>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label" id="passwordLabel">Senha</label>
                <input type="password" class="form-control" id="password" required>
            </div>
            <button type="submit" class="btn btn-primary w-100" id="loginButton">Entrar</button>
        </form>
    </div>

    <script>
        const translations = {
            pt: {
                loginTitle: 'Login',
                usernameLabel: 'Nome de usuário',
                passwordLabel: 'Senha',
                loginButton: 'Entrar',
                alertInvalid: 'Usuário ou senha incorretos'
            },
            en: {
                loginTitle: 'Login',
                usernameLabel: 'Username',
                passwordLabel: 'Password',
                loginButton: 'Login',
                alertInvalid: 'Invalid username or password'
            }
        };

        function setLanguage(lang) {
            const t = translations[lang];
            document.getElementById('loginTitle').innerText = t.loginTitle;
            document.getElementById('usernameLabel').innerText = t.usernameLabel;
            document.getElementById('passwordLabel').innerText = t.passwordLabel;
            document.getElementById('loginButton').innerText = t.loginButton;
            localStorage.setItem('lang', lang);
        }

        document.getElementById('languageSelect').addEventListener('change', function () {
            setLanguage(this.value);
        });

        window.addEventListener('DOMContentLoaded', () => {
            const savedLang = localStorage.getItem('lang') || 'pt';
            document.getElementById('languageSelect').value = savedLang;
            setLanguage(savedLang);
        });

        document.getElementById('loginForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const users = JSON.parse(localStorage.getItem('usuarios')) || [];
            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                localStorage.setItem('usuarioLogado', JSON.stringify(user));
                window.location.href = 'index.html';
            } else {
                const lang = localStorage.getItem('lang') || 'pt';
                alert(translations[lang].alertInvalid);
            }
        });

    function logout() {
      location.reload();
    }

    function addUser() {
      const user = document.getElementById("new-user").value;
      const pass = document.getElementById("new-pass").value;
      if (!user || !pass) return;
      users.push({ user, pass });
      saveUsers();
      document.getElementById("new-user").value = '';
      document.getElementById("new-pass").value = '';
    }

    function deleteUser(index) {
      users.splice(index, 1);
      saveUsers();
    }

    function addCall() {
      const student = document.getElementById("student-name").value;
      if (!student) return;
      calls.push({ student, professor: currentUser });
      saveCalls();
      document.getElementById("student-name").value = '';
    }

    function deleteCall(index) {
      calls.splice(index, 1);
      saveCalls();
    }

    function showAdmin() {
      document.getElementById("login-section").classList.add("hidden");
      document.getElementById("admin-section").classList.remove("hidden");
      document.getElementById("professor-section").classList.remove("hidden");
      renderUsers();
      renderCalls();
    }

    function showProfessor() {
      document.getElementById("login-section").classList.add("hidden");
      document.getElementById("professor-section").classList.remove("hidden");
      renderCalls();
    }

    function renderUsers() {
      const list = document.getElementById("user-list");
      list.innerHTML = "";
      users.forEach((u, i) => {
        list.innerHTML += `<tr>
          <td>${u.user}</td>
          <td>${u.pass}</td>
          <td><button onclick="deleteUser(${i})">${translate("Excluir", "Delete")}</button></td>
        </tr>`;
      });
    }

    function renderCalls() {
      const list = document.getElementById("call-list");
      list.innerHTML = "";
      calls.forEach((c, i) => {
        if (currentUser === "admin" || c.professor === currentUser) {
          list.innerHTML += `<tr>
            <td>${c.student}</td>
            <td>${c.professor}</td>
            <td><button onclick="deleteCall(${i})">${translate("Excluir", "Delete")}</button></td>
          </tr>`;
        }
      });
    }

    function toggleLang() {
      currentLang = currentLang === 'pt' ? 'en' : 'pt';
      document.getElementById("lang-btn").innerText = currentLang === 'pt' ? 'EN' : 'PT';
      applyTranslations();
    }

    function translate(pt, en) {
      return currentLang === 'pt' ? pt : en;
    }

    function applyTranslations() {
      document.getElementById("title").innerText = translate("Login", "Login");
      document.getElementById("admin-title").innerText = translate("Usuários Cadastrados", "Registered Users");
      document.getElementById("call-title").innerText = translate("Lista de Chamada", "Attendance List");

      document.querySelectorAll("input").forEach(input => {
        if (input.placeholder.includes("Usuário")) input.placeholder = translate("Usuário", "Username");
        if (input.placeholder.includes("Senha")) input.placeholder = translate("Senha", "Password");
        if (input.placeholder.includes("Novo usuário")) input.placeholder = translate("Novo usuário", "New user");
        if (input.placeholder.includes("Nome do aluno")) input.placeholder = translate("Nome do aluno", "Student name");
      });

      document.querySelectorAll("button").forEach(btn => {
        if (btn.innerText.includes("Entrar")) btn.innerText = translate("Entrar", "Login");
        if (btn.innerText.includes("Cadastrar")) btn.innerText = translate("Cadastrar", "Register");
        if (btn.innerText.includes("Adicionar Chamada")) btn.innerText = translate("Adicionar Chamada", "Add Attendance");
        if (btn.innerText.includes("Excluir")) btn.innerText = translate("Excluir", "Delete");
        if (btn.innerText.includes("Logout")) btn.innerText = translate("Logout", "Logout");
      });
    }

    applyTranslations();
  </script>
</body>
</html>