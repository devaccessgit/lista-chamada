<!-- Salve como index.html -->
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lista de Chamada</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .top-bar {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    .hidden {
      display: none;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    button {
      padding: 5px 10px;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <button onclick="toggleLang()">游깷 <span id="lang-btn">EN</span></button>
    <button onclick="logout()">Logout</button>
  </div>

  <h2 id="title">Login</h2>
  <div id="login-section">
    <input id="username" placeholder="Usu치rio" /><br/>
    <input id="password" type="password" placeholder="Senha" /><br/>
    <button onclick="login()">Entrar</button>
  </div>

  <div id="admin-section" class="hidden">
    <h3 id="admin-title">Usu치rios Cadastrados</h3>
    <table>
      <thead>
        <tr>
          <th>Usu치rio</th>
          <th>Senha</th>
          <th>A칞칚o</th>
        </tr>
      </thead>
      <tbody id="user-list"></tbody>
    </table>
    <input id="new-user" placeholder="Novo usu치rio" />
    <input id="new-pass" placeholder="Senha" type="password"/>
    <button onclick="addUser()">Cadastrar</button>
  </div>

  <div id="professor-section" class="hidden">
    <h3 id="call-title">Lista de Chamada</h3>
    <input id="student-name" placeholder="Nome do aluno" />
    <button onclick="addCall()">Adicionar Chamada</button>
    <table>
      <thead>
        <tr>
          <th>Aluno</th>
          <th>Professor</th>
          <th>A칞칚o</th>
        </tr>
      </thead>
      <tbody id="call-list"></tbody>
    </table>
  </div>

  <script>
    let currentUser = '';
    let currentLang = 'pt';

    const users = JSON.parse(localStorage.getItem("users") || "[]");
    const calls = JSON.parse(localStorage.getItem("calls") || "[]");

    function saveUsers() {
      localStorage.setItem("users", JSON.stringify(users));
      renderUsers();
    }

    function saveCalls() {
      localStorage.setItem("calls", JSON.stringify(calls));
      renderCalls();
    }

    function login() {
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;
      if (user === "admin" && pass === "admin123") {
        currentUser = "admin";
        showAdmin();
      } else {
        const found = users.find(u => u.user === user && u.pass === pass);
        if (found) {
          currentUser = user;
          showProfessor();
        } else {
          alert(translate("Usu치rio ou senha inv치lidos", "Invalid username or password"));
        }
      }
    }

    function logout() {
      location.reload();
    }

    function addUser() {
      const user = document.getElementById("new-user").value;
      const pass = document.getElementById("new-pass").value;
      if (!user || !pass) return;
      users.push({ user, pass });
      saveUsers();
      document.getElementById("new-user").value = '';
      document.getElementById("new-pass").value = '';
    }

    function deleteUser(index) {
      users.splice(index, 1);
      saveUsers();
    }

    function addCall() {
      const student = document.getElementById("student-name").value;
      if (!student) return;
      calls.push({ student, professor: currentUser });
      saveCalls();
      document.getElementById("student-name").value = '';
    }

    function deleteCall(index) {
      calls.splice(index, 1);
      saveCalls();
    }

    function showAdmin() {
      document.getElementById("login-section").classList.add("hidden");
      document.getElementById("admin-section").classList.remove("hidden");
      document.getElementById("professor-section").classList.remove("hidden");
      renderUsers();
      renderCalls();
    }

    function showProfessor() {
      document.getElementById("login-section").classList.add("hidden");
      document.getElementById("professor-section").classList.remove("hidden");
      renderCalls();
    }

    function renderUsers() {
      const list = document.getElementById("user-list");
      list.innerHTML = "";
      users.forEach((u, i) => {
        list.innerHTML += `<tr>
          <td>${u.user}</td>
          <td>${u.pass}</td>
          <td><button onclick="deleteUser(${i})">${translate("Excluir", "Delete")}</button></td>
        </tr>`;
      });
    }

    function renderCalls() {
      const list = document.getElementById("call-list");
      list.innerHTML = "";
      calls.forEach((c, i) => {
        if (currentUser === "admin" || c.professor === currentUser) {
          list.innerHTML += `<tr>
            <td>${c.student}</td>
            <td>${c.professor}</td>
            <td><button onclick="deleteCall(${i})">${translate("Excluir", "Delete")}</button></td>
          </tr>`;
        }
      });
    }

    function toggleLang() {
      currentLang = currentLang === 'pt' ? 'en' : 'pt';
      document.getElementById("lang-btn").innerText = currentLang === 'pt' ? 'EN' : 'PT';
      applyTranslations();
    }

    function translate(pt, en) {
      return currentLang === 'pt' ? pt : en;
    }

    function applyTranslations() {
      document.getElementById("title").innerText = translate("Login", "Login");
      document.getElementById("admin-title").innerText = translate("Usu치rios Cadastrados", "Registered Users");
      document.getElementById("call-title").innerText = translate("Lista de Chamada", "Attendance List");

      document.querySelectorAll("input").forEach(input => {
        if (input.placeholder.includes("Usu치rio")) input.placeholder = translate("Usu치rio", "Username");
        if (input.placeholder.includes("Senha")) input.placeholder = translate("Senha", "Password");
        if (input.placeholder.includes("Novo usu치rio")) input.placeholder = translate("Novo usu치rio", "New user");
        if (input.placeholder.includes("Nome do aluno")) input.placeholder = translate("Nome do aluno", "Student name");
      });

      document.querySelectorAll("button").forEach(btn => {
        if (btn.innerText.includes("Entrar")) btn.innerText = translate("Entrar", "Login");
        if (btn.innerText.includes("Cadastrar")) btn.innerText = translate("Cadastrar", "Register");
        if (btn.innerText.includes("Adicionar Chamada")) btn.innerText = translate("Adicionar Chamada", "Add Attendance");
        if (btn.innerText.includes("Excluir")) btn.innerText = translate("Excluir", "Delete");
        if (btn.innerText.includes("Logout")) btn.innerText = translate("Logout", "Logout");
      });
    }

    applyTranslations();
  </script>
</body>
</html>